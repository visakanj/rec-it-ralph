<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Rec-It-Ralph</title>
  <link rel="stylesheet" href="/v2/app-shell.css">
</head>
<body>
  <!-- Safe area aware top bar -->
  <header class="top-bar">
    <h1 class="app-title">Rec-It-Ralph</h1>
    <div class="room-badge" id="v2-room-code">---</div>
  </header>

  <!-- Screen container (active tab renders here) -->
  <main id="screen-container" class="screen-container">
    <!-- Placeholder screens render here -->
  </main>

  <!-- Bottom tab bar (iOS-style) -->
  <nav class="tab-bar">
    <button class="tab-button" data-tab="rooms">
      <span class="tab-icon">üè†</span>
      <span class="tab-label">Rooms</span>
    </button>
    <button class="tab-button" data-tab="pool">
      <span class="tab-icon">üé¨</span>
      <span class="tab-label">Pool</span>
    </button>
    <button class="tab-button" data-tab="tonight">
      <span class="tab-icon">üçø</span>
      <span class="tab-label">Tonight</span>
    </button>
    <button class="tab-button" data-tab="watched">
      <span class="tab-icon">‚úì</span>
      <span class="tab-label">Watched</span>
    </button>
  </nav>

  <!-- V2 MODE FLAG: Set before loading app.js -->
  <script>
    window.RECITRALPH_V2_MODE = true;
    console.log('[v2 early - checkpoint 1]', {
      hasFirebase: !!window.firebase,
      hasDatabase: !!window.database,
      readyState: document.readyState
    });
  </script>

  <!-- Load Firebase SDK (same version as v1) -->
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

  <script>
    // Firebase configuration (same as v1)
    const firebaseConfig = {
      apiKey: "AIzaSyATWPODhqbeIpGrpbwYeTJG-m2LFAD0yEY",
      authDomain: "rec-it-ralph-f086b.firebaseapp.com",
      databaseURL: "https://rec-it-ralph-f086b-default-rtdb.firebaseio.com",
      projectId: "rec-it-ralph-f086b",
      storageBucket: "rec-it-ralph-f086b.firebasestorage.app",
      messagingSenderId: "59142094523",
      appId: "1:59142094523:web:fd8d6c899125f62b23739e",
      measurementId: "G-F8VYDHN758"
    };

    // Initialize Firebase
    if (typeof firebase !== 'undefined') {
      try {
        firebase.initializeApp(firebaseConfig);
        window.database = firebase.database();
        console.log('Firebase initialized successfully');
      } catch (error) {
        console.warn('Firebase initialization failed, falling back to localStorage:', error);
        window.database = null;
      }
    }
  </script>

  <script>
    console.log('[v2 after Firebase SDK - checkpoint 2]', {
      hasFirebase: !!window.firebase,
      hasDatabase: !!window.database,
      firebaseType: typeof window.firebase,
      databaseType: typeof window.database
    });
  </script>

  <!-- Load v1 core logic (guarded - won't initialize UIController) -->
  <script>
    console.log('[v2 before app.js - checkpoint 3]', {
      hasFirebase: !!window.firebase,
      hasDatabase: !!window.database
    });
  </script>
  <script src="/app.js"></script>
  <script>
    console.log('[v2 after app.js - checkpoint 4]', {
      hasFirebase: !!window.firebase,
      hasDatabase: !!window.database,
      hasAppState: !!window.appState
    });
  </script>

  <!-- Load v2 code -->
  <script>
    console.log('[v2 before data-adapter - checkpoint 5]', {
      hasFirebase: !!window.firebase,
      hasDatabase: !!window.database,
      hasAppState: !!window.appState
    });
  </script>
  <script src="/v2/data-adapter.js"></script>
  <script src="/v2/screens/rooms.js"></script>
  <script src="/v2/screens/pool.js"></script>
  <script src="/v2/screens/tonight.js"></script>
  <script src="/v2/screens/watched.js"></script>
  <script src="/v2/app-shell.js"></script>
</body>
</html>
